{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.13", "generated_at": "2025-11-20T12:43:15.636524Z", "invocation_id": "0312ad6b-b53d-47f9-8284-062cd48f0039", "invocation_started_at": "2025-11-20T12:43:05.916142Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T12:43:12.356915Z", "completed_at": "2025-11-20T12:43:12.369077Z"}, {"name": "execute", "started_at": "2025-11-20T12:43:12.369953Z", "completed_at": "2025-11-20T12:43:13.204584Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.8493783473968506, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dataengineering_dbt.stg_live_timetable", "compiled": true, "compiled_code": "-- Staging model: SIRI live timetable from bronze\r\n-- Expanded to expose all Bronze columns expected by downstream silver/gold models.\r\nselect\r\n  ServiceJourneyId,\r\n  QuayId,\r\n  StopPointId,\r\n  DateId,\r\n  LineId,\r\n  RouteId,\r\n  DirectionRef,\r\n  VehicleMode,\r\n  AimedArrivalTime,\r\n  ActualArrivalTime,\r\n  AimedDepartureTime,\r\n  ActualDepartureTime,\r\n  ArrivalStatus,\r\n  DepartureStatus,\r\n  Cancellation,\r\n  DepartureBoardingActivity,\r\n  Ingestion_Date\r\nfrom bronze_live_timetable\r\nwhere ServiceJourneyId is not null", "relation_name": "`default`.`stg_live_timetable`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T12:43:13.218179Z", "completed_at": "2025-11-20T12:43:13.222284Z"}, {"name": "execute", "started_at": "2025-11-20T12:43:13.223415Z", "completed_at": "2025-11-20T12:43:13.352349Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.13591241836547852, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dataengineering_dbt.stg_netex_lines", "compiled": true, "compiled_code": "-- Staging model: NetEx lines from bronze\r\nselect\r\n  id,\r\n  -- Use ClickHouse JSON extraction functions instead of parse_json(...) syntax\r\n  -- JSONExtractString returns the string value for the given key\r\n  JSONExtractString(payload, 'Name') as name,\r\n  JSONExtractString(payload, 'PublicCode') as public_code,\r\n  -- Optional route / direction fields (may be absent in some NetEx payloads)\r\n  JSONExtractString(payload, 'RouteRef') as route_id,\r\n  JSONExtractString(payload, 'DirectionRef') as direction,\r\n  Ingestion_Date\r\nfrom bronze_netex_lines\r\nwhere id is not null", "relation_name": "`default`.`stg_netex_lines`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T12:43:13.366470Z", "completed_at": "2025-11-20T12:43:13.371892Z"}, {"name": "execute", "started_at": "2025-11-20T12:43:13.373189Z", "completed_at": "2025-11-20T12:43:13.494273Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.13149309158325195, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dataengineering_dbt.stg_netex_quays", "compiled": true, "compiled_code": "-- Staging model: NetEx quays from bronze\r\nselect\r\n  id as QuayId,\r\n  JSONExtractString(payload, 'name') as QuayName,\r\n  JSONExtractString(payload, 'stopPlaceId') as StopPlaceId, --ParentStopPointId,\r\n  -- Location composed from centroid latitude/longitude if present in the payload\r\n  concat(\r\n    coalesce(JSONExtractString(payload, 'Centroid_Lat'), ''),\r\n    ',',\r\n    coalesce(JSONExtractString(payload, 'Centroid_Long'), '')\r\n  ) as Location,\r\n  Ingestion_Date\r\nfrom bronze_netex_quays\r\nwhere id is not null", "relation_name": "`default`.`stg_netex_quays`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T12:43:13.501686Z", "completed_at": "2025-11-20T12:43:13.505557Z"}, {"name": "execute", "started_at": "2025-11-20T12:43:13.506679Z", "completed_at": "2025-11-20T12:43:13.631933Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.13204646110534668, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dataengineering_dbt.stg_netex_stopplaces", "compiled": true, "compiled_code": "-- Staging model: NeTEx stop places from bronze\r\n-- Expanded to expose all Bronze columns expected by downstream silver/gold models.\r\nSELECT\r\n  --id,\r\n  JSONExtractString(payload, 'id') AS StopPlaceId,\r\n--  JSONExtractString(payload, 'StopPointId') AS StopPointId,\r\n  JSONExtractString(payload, 'Name') AS Name,\r\n  JSONExtractString(payload, 'ShortName') AS ShortName,\r\n  JSONExtractFloat(payload, 'Centroid_Long') AS Centroid_Long,\r\n  JSONExtractFloat(payload, 'Centroid_Lat') AS Centroid_Lat,\r\n  JSONExtractString(payload, 'StopPlaceType') AS StopPlaceType,\r\n  JSONExtractString(payload, 'ParentStopPlaceId') AS ParentStopPlaceId,\r\n  Ingestion_Date AS Ingestion_Date\r\nFROM bronze_netex_stop_places\r\nWHERE JSONExtractString(payload, 'id') IS NOT NULL", "relation_name": "`default`.`stg_netex_stopplaces`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T12:43:13.639575Z", "completed_at": "2025-11-20T12:43:13.649047Z"}, {"name": "execute", "started_at": "2025-11-20T12:43:13.650406Z", "completed_at": "2025-11-20T12:43:13.781707Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.14369988441467285, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dataengineering_dbt.silver_timetable", "compiled": true, "compiled_code": "-- Silver layer: clean timetable with all required fields\nselect\n  ServiceJourneyId,\n  QuayId,\n  StopPointId,\n  cast(AimedArrivalTime as Date) as DateId,\n  LineId,\n  RouteId,\n  DirectionRef,\n  VehicleMode,\n  AimedArrivalTime,\n  ActualArrivalTime,\n  AimedDepartureTime,\n  ActualDepartureTime,\n  ArrivalStatus,\n  DepartureStatus,\n  Cancellation,\n  DepartureBoardingActivity,\n  Ingestion_Date\nfrom `default`.`stg_live_timetable`\nwhere ActualArrivalTime is not null", "relation_name": "`default`.`silver_timetable`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T12:43:13.789729Z", "completed_at": "2025-11-20T12:43:13.797302Z"}, {"name": "execute", "started_at": "2025-11-20T12:43:13.798118Z", "completed_at": "2025-11-20T12:43:13.931891Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.14396381378173828, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dataengineering_dbt.silver_lines", "compiled": true, "compiled_code": "-- Silver layer: deduplicate lines with route and direction\nselect\n  id,\n  name,\n  public_code,\n  route_id,\n  direction,\n  Ingestion_Date\nfrom `default`.`stg_netex_lines`\ngroup by id, name, public_code, route_id, direction, Ingestion_Date", "relation_name": "`default`.`silver_lines`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T12:43:13.946523Z", "completed_at": "2025-11-20T12:43:13.955663Z"}, {"name": "execute", "started_at": "2025-11-20T12:43:13.957010Z", "completed_at": "2025-11-20T12:43:14.084057Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.14149904251098633, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dataengineering_dbt.silver_stop_places", "compiled": true, "compiled_code": "-- Silver layer: clean stop places with all required fields\nselect\n  StopPlaceId,\n  --StopPointId,\n  Name,\n  ShortName,\n  Centroid_Long,\n  Centroid_Lat,\n  StopPlaceType,\n  ParentStopPlaceId,\n  Ingestion_Date\nfrom `default`.`stg_netex_stopplaces`", "relation_name": "`default`.`silver_stop_places`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T12:43:14.096184Z", "completed_at": "2025-11-20T12:43:14.103443Z"}, {"name": "execute", "started_at": "2025-11-20T12:43:14.104611Z", "completed_at": "2025-11-20T12:43:14.520993Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.4272329807281494, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dataengineering_dbt.dim_quay", "compiled": true, "compiled_code": "-- Expanded Quay dimension\n-- Use NetEx quays staging model for quay metadata (name, parent stop point, location)\nselect distinct\n  QuayId as quay_id,\n  --StopPointId as stop_point_id,\n  StopPlaceId as stop_place_id,\n  QuayName as quay_name,\n  Location as location\n  --ParentStopPointId as parent_stop_point_id\nfrom `default`.`stg_netex_quays` q\nleft join `default`.`silver_timetable` s\n  on q.QuayId = s.QuayId\nwhere q.QuayId is not null", "relation_name": "`default`.`dim_quay`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T12:43:14.529175Z", "completed_at": "2025-11-20T12:43:14.534760Z"}, {"name": "execute", "started_at": "2025-11-20T12:43:14.535518Z", "completed_at": "2025-11-20T12:43:14.788540Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.2608661651611328, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dataengineering_dbt.dim_service_journey", "compiled": true, "compiled_code": "-- Expanded ServiceJourney dimension\nselect distinct\n  ServiceJourneyId as service_journey_id,\n  cast(AimedArrivalTime as Date) as date_id,\n  DirectionRef as direction,\n  VehicleMode,\n  LineId as line_id,\n  RouteId as route_id\nfrom `default`.`silver_timetable`\nwhere ServiceJourneyId is not null", "relation_name": "`default`.`dim_service_journey`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T12:43:14.796337Z", "completed_at": "2025-11-20T12:43:14.800953Z"}, {"name": "execute", "started_at": "2025-11-20T12:43:14.801975Z", "completed_at": "2025-11-20T12:43:15.048370Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.25341153144836426, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dataengineering_dbt.fact_movements", "compiled": true, "compiled_code": "-- Expanded star schema fact table for Events\nselect\n  row_number() over (order by ServiceJourneyId, QuayId, AimedArrivalTime) as event_id,\n  ServiceJourneyId as service_journey_id,\n  QuayId as quay_id,\n  --StopPointId as stop_point_id,\n  cast(AimedArrivalTime as Date) as date_id,\n  --LineId as line_id,\n  --RouteId as route_id,\n  --DirectionRef as direction,\n  --VehicleMode,\n  AimedArrivalTime,\n  ActualArrivalTime,\n  AimedDepartureTime,\n  ActualDepartureTime,\n  --ArrivalStatus,\n  --DepartureStatus,\n  --Cancellation,\n  --DepartureBoardingActivity,\n  Ingestion_Date\nfrom `default`.`silver_timetable`", "relation_name": "`default`.`fact_movements`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T12:43:15.054247Z", "completed_at": "2025-11-20T12:43:15.060486Z"}, {"name": "execute", "started_at": "2025-11-20T12:43:15.061245Z", "completed_at": "2025-11-20T12:43:15.325917Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.2731044292449951, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dataengineering_dbt.dim_line", "compiled": true, "compiled_code": "-- Expanded Line dimension\nselect\n  id as line_id,\n  name,\n  public_code,\n  route_id,\n  direction\nfrom `default`.`silver_lines`", "relation_name": "`default`.`dim_line`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-20T12:43:15.332135Z", "completed_at": "2025-11-20T12:43:15.336889Z"}, {"name": "execute", "started_at": "2025-11-20T12:43:15.337599Z", "completed_at": "2025-11-20T12:43:15.625801Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.295102596282959, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dataengineering_dbt.dim_stop_place", "compiled": true, "compiled_code": "select\n  row_number() over (\n      order by s.ServiceJourneyId, s.QuayId, s.AimedArrivalTime\n  ) as event_id,\n  sp.StopPlaceId as stop_place_id,\n  --sp.StopPointId as stop_point_id,\n  cast(s.AimedArrivalTime as Date) as date_id,\n  sp.Name as stop_point_name,\n  sp.ShortName as stop_point_short_name,\n  sp.Centroid_Long,\n  sp.Centroid_Lat,\n  sp.StopPlaceType,\n  sp.ParentStopPlaceId,\n  sp.Ingestion_Date\nfrom `default`.`silver_stop_places` as sp\nleft join `default`.`silver_timetable` as s\n  --on s.StopPointId = sp.StopPointId\n  on s.StopPointId = sp.StopPlaceId\nwhere sp.StopPlaceId is not null", "relation_name": "`default`.`dim_stop_place`", "batch_results": null}], "elapsed_time": 6.734065294265747, "args": {"skip_nodes_if_on_run_start_fails": false, "use_fast_test_edges": false, "printer_width": 80, "show_all_deprecations": false, "exclude": [], "warn_error_options": {"error": [], "warn": [], "silence": []}, "static_parser": true, "require_batched_execution_for_custom_microbatch_strategy": false, "require_all_warnings_handled_by_warn_error": false, "indirect_selection": "eager", "empty": false, "validate_macro_args": false, "vars": {}, "log_format": "default", "partial_parse_file_diff": true, "log_path": "C:\\Users\\marti\\OneDrive\\Documents\\Andmetehnika (dataeng)\\dataengineering_project\\dbt\\logs", "partial_parse": true, "require_generic_test_arguments_property": true, "introspect": true, "select": [], "upload_to_artifacts_ingest_api": false, "log_file_max_bytes": 10485760, "cache_selected_only": false, "log_level_file": "debug", "log_format_file": "debug", "show_resource_report": false, "invocation_command": "dbt run --full-refresh", "state_modified_compare_more_unrendered_values": false, "log_level": "info", "strict_mode": false, "version_check": true, "require_yaml_configuration_for_mf_time_spines": false, "require_explicit_package_overrides_for_builtin_materializations": true, "populate_cache": true, "print": true, "require_nested_cumulative_type_params": false, "favor_state": false, "which": "run", "project_dir": "C:\\Users\\marti\\OneDrive\\Documents\\Andmetehnika (dataeng)\\dataengineering_project\\dbt", "quiet": false, "send_anonymous_usage_stats": true, "source_freshness_run_project_hooks": true, "state_modified_compare_vars": false, "use_colors": true, "full_refresh": true, "require_resource_names_without_spaces": true, "use_colors_file": true, "write_json": true, "macro_debugging": false, "profiles_dir": "C:\\Users\\marti\\OneDrive\\Documents\\Andmetehnika (dataeng)\\dataengineering_project\\dbt", "defer": false}}