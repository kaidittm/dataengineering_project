{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.13", "generated_at": "2025-11-02T10:26:51.158433Z", "invocation_id": "7ae4ace8-ff26-49a1-9052-c68db8c60c3d", "invocation_started_at": "2025-11-02T10:26:48.247948Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-02T10:26:50.046868Z", "completed_at": "2025-11-02T10:26:50.072679Z"}, {"name": "execute", "started_at": "2025-11-02T10:26:50.074772Z", "completed_at": "2025-11-02T10:26:50.211076Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1680588722229004, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dataengineering_dbt.stg_live_timetable", "compiled": true, "compiled_code": "-- Staging model: SIRI live timetable from bronze\r\n-- Staging model: SIRI live timetable from bronze\r\n-- Expanded to expose all Bronze columns expected by downstream silver/gold models.\r\nselect\r\n  ServiceJourneyId,\r\n  QuayId,\r\n  StopPointId,\r\n  DateId,\r\n  LineId,\r\n  RouteId,\r\n  DirectionRef,\r\n  VehicleMode,\r\n  AimedArrivalTime,\r\n  ActualArrivalTime,\r\n  AimedDepartureTime,\r\n  ActualDepartureTime,\r\n  ArrivalStatus,\r\n  DepartureStatus,\r\n  Cancellation,\r\n  DepartureBoardingActivity,\r\n  Ingestion_Date\r\nfrom bronze_live_timetable\r\nwhere ServiceJourneyId is not null", "relation_name": "`default`.`stg_live_timetable`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-02T10:26:50.226985Z", "completed_at": "2025-11-02T10:26:50.243858Z"}, {"name": "execute", "started_at": "2025-11-02T10:26:50.245447Z", "completed_at": "2025-11-02T10:26:50.291048Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06815290451049805, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dataengineering_dbt.stg_netex_lines", "compiled": true, "compiled_code": "-- Staging model: NetEx lines from bronze\r\n-- Staging model: NetEx lines from bronze\r\nselect\r\n  id,\r\n  -- Use ClickHouse JSON extraction functions instead of parse_json(...) syntax\r\n  -- JSONExtractString returns the string value for the given key\r\n  JSONExtractString(payload, 'Name') as name,\r\n  JSONExtractString(payload, 'PublicCode') as public_code,\r\n  -- Optional route / direction fields (may be absent in some NetEx payloads)\r\n  JSONExtractString(payload, 'RouteRef') as route_id,\r\n  JSONExtractString(payload, 'DirectionRef') as direction,\r\n  Ingestion_Date\r\nfrom bronze_netex_lines\r\nwhere id is not null", "relation_name": "`default`.`stg_netex_lines`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-02T10:26:50.306002Z", "completed_at": "2025-11-02T10:26:50.323374Z"}, {"name": "execute", "started_at": "2025-11-02T10:26:50.325179Z", "completed_at": "2025-11-02T10:26:50.372654Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07133698463439941, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dataengineering_dbt.stg_netex_quays", "compiled": true, "compiled_code": "-- Staging model: NetEx quays from bronze\r\nselect\r\n  id as QuayId,\r\n  JSONExtractString(payload, 'Name') as QuayName,\r\n  JSONExtractString(payload, 'stopPlaceId') as ParentStopPointId,\r\n  -- Location composed from centroid latitude/longitude if present in the payload\r\n  concat(\r\n    coalesce(JSONExtractString(payload, 'Centroid_Lat'), ''),\r\n    ',',\r\n    coalesce(JSONExtractString(payload, 'Centroid_Long'), '')\r\n  ) as Location,\r\n  Ingestion_Date\r\nfrom bronze_netex_quays\r\nwhere id is not null", "relation_name": "`default`.`stg_netex_quays`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-02T10:26:50.387816Z", "completed_at": "2025-11-02T10:26:50.405788Z"}, {"name": "execute", "started_at": "2025-11-02T10:26:50.407463Z", "completed_at": "2025-11-02T10:26:50.454601Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07166147232055664, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dataengineering_dbt.silver_timetable", "compiled": true, "compiled_code": "-- Silver layer: clean timetable with all required fields\nselect\n  ServiceJourneyId,\n  QuayId,\n  StopPointId,\n  cast(AimedArrivalTime as Date) as DateId,\n  LineId,\n  RouteId,\n  DirectionRef,\n  VehicleMode,\n  AimedArrivalTime,\n  ActualArrivalTime,\n  AimedDepartureTime,\n  ActualDepartureTime,\n  ArrivalStatus,\n  DepartureStatus,\n  Cancellation,\n  DepartureBoardingActivity,\n  Ingestion_Date\nfrom `default`.`stg_live_timetable`\nwhere ActualArrivalTime is not null", "relation_name": "`default`.`silver_timetable`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-02T10:26:50.468938Z", "completed_at": "2025-11-02T10:26:50.485961Z"}, {"name": "execute", "started_at": "2025-11-02T10:26:50.488113Z", "completed_at": "2025-11-02T10:26:50.536684Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07198405265808105, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dataengineering_dbt.silver_lines", "compiled": true, "compiled_code": "-- Silver layer: deduplicate lines with route and direction\nselect\n  id,\n  name,\n  public_code,\n  route_id,\n  direction,\n  Ingestion_Date\nfrom `default`.`stg_netex_lines`\ngroup by id, name, public_code, route_id, direction, Ingestion_Date", "relation_name": "`default`.`silver_lines`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-02T10:26:50.551516Z", "completed_at": "2025-11-02T10:26:50.570120Z"}, {"name": "execute", "started_at": "2025-11-02T10:26:50.571773Z", "completed_at": "2025-11-02T10:26:50.758914Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.21158480644226074, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dataengineering_dbt.dim_quay", "compiled": true, "compiled_code": "-- Expanded Quay dimension\n-- Use NetEx quays staging model for quay metadata (name, parent stop point, location)\nselect distinct\n  QuayId as quay_id,\n  StopPointId as stop_point_id,\n  QuayName as quay_name,\n  Location as location,\n  ParentStopPointId as parent_stop_point_id\nfrom `default`.`stg_netex_quays` q\nleft join `default`.`silver_timetable` s\n  on q.QuayId = s.QuayId\nwhere q.QuayId is not null", "relation_name": "`default`.`dim_quay`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-02T10:26:50.773874Z", "completed_at": "2025-11-02T10:26:50.791266Z"}, {"name": "execute", "started_at": "2025-11-02T10:26:50.792889Z", "completed_at": "2025-11-02T10:26:50.883087Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.11299896240234375, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dataengineering_dbt.dim_service_journey", "compiled": true, "compiled_code": "-- Expanded ServiceJourney dimension\nselect distinct\n  ServiceJourneyId as service_journey_id,\n  cast(AimedArrivalTime as Date) as date_id,\n  DirectionRef as direction,\n  VehicleMode,\n  LineId as line_id,\n  RouteId as route_id\nfrom `default`.`silver_timetable`\nwhere ServiceJourneyId is not null", "relation_name": "`default`.`dim_service_journey`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-02T10:26:50.896989Z", "completed_at": "2025-11-02T10:26:50.914610Z"}, {"name": "execute", "started_at": "2025-11-02T10:26:50.916572Z", "completed_at": "2025-11-02T10:26:51.009205Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.11652088165283203, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dataengineering_dbt.fact_movements", "compiled": true, "compiled_code": "-- Expanded star schema fact table for Events\nselect\n  row_number() over (order by ServiceJourneyId, QuayId, AimedArrivalTime) as event_id,\n  ServiceJourneyId as service_journey_id,\n  QuayId as quay_id,\n  StopPointId as stop_point_id,\n  cast(AimedArrivalTime as Date) as date_id,\n  LineId as line_id,\n  RouteId as route_id,\n  DirectionRef as direction,\n  VehicleMode,\n  AimedArrivalTime,\n  ActualArrivalTime,\n  AimedDepartureTime,\n  ActualDepartureTime,\n  ArrivalStatus,\n  DepartureStatus,\n  Cancellation,\n  DepartureBoardingActivity,\n  Ingestion_Date\nfrom `default`.`silver_timetable`", "relation_name": "`default`.`fact_movements`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-02T10:26:51.022811Z", "completed_at": "2025-11-02T10:26:51.040443Z"}, {"name": "execute", "started_at": "2025-11-02T10:26:51.042200Z", "completed_at": "2025-11-02T10:26:51.140108Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.12109851837158203, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.dataengineering_dbt.dim_line", "compiled": true, "compiled_code": "-- Expanded Line dimension\nselect\n  id as line_id,\n  name,\n  public_code,\n  route_id,\n  direction\nfrom `default`.`silver_lines`", "relation_name": "`default`.`dim_line`", "batch_results": null}], "elapsed_time": 1.3258399963378906, "args": {"require_generic_test_arguments_property": true, "populate_cache": true, "write_json": true, "defer": false, "require_yaml_configuration_for_mf_time_spines": false, "empty": false, "state_modified_compare_more_unrendered_values": false, "log_level_file": "debug", "require_all_warnings_handled_by_warn_error": false, "quiet": false, "select": [], "favor_state": false, "version_check": true, "state_modified_compare_vars": false, "strict_mode": false, "log_level": "info", "upload_to_artifacts_ingest_api": false, "use_colors_file": true, "show_resource_report": false, "which": "run", "log_format_file": "debug", "show_all_deprecations": false, "invocation_command": "dbt run --profiles-dir /dbt", "source_freshness_run_project_hooks": true, "project_dir": "/dbt", "log_path": "/dbt/logs", "print": true, "log_file_max_bytes": 10485760, "skip_nodes_if_on_run_start_fails": false, "send_anonymous_usage_stats": true, "vars": {}, "introspect": true, "require_batched_execution_for_custom_microbatch_strategy": false, "require_resource_names_without_spaces": true, "exclude": [], "cache_selected_only": false, "static_parser": true, "require_explicit_package_overrides_for_builtin_materializations": true, "use_colors": true, "partial_parse": true, "partial_parse_file_diff": true, "warn_error_options": {"error": [], "warn": [], "silence": []}, "require_nested_cumulative_type_params": false, "validate_macro_args": false, "use_fast_test_edges": false, "macro_debugging": false, "printer_width": 80, "profiles_dir": "/dbt", "indirect_selection": "eager", "log_format": "default"}}